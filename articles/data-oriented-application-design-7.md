---
title: "データ指向アプリケーションデザイン 2部 7章 まとめ"
type: "idea"
topics: ["トランザクション", "", "memo"]
published: false
---
# はじめに
データ指向アプリケーションデザインを読んでいるので自分の理解のためにメモをまとめます。  
概要では全体に書いてあること、詳細では概要のそれぞれの要素についてを書きます。  
2部は5〜9章まであり、複数のノードにデータを分散させる手法のレプリケーション(5章)、パーティショニング(6章)についての説明、7章ではトランザクション、8、9章では分散システムの制約について記載します。

# 概要
トランザクションはシステムが障害に対処するための仕組み。  
具体的な動作としては、アプリケーションが複数の処理を論理的なまとまりとして扱う。  

トランザクションが提供する安全性の保証はACIDと呼ばれる。  
- Atomic: 原子性。エラーの際にトランザクションを中断した場合にそのトランザクションの変更を破棄することができる。  
- Consistency: 一貫性。アプリケーションがトランザクションのAtomic、Isolationの特性を用いてデータの一貫性を保つことができる。  
- Isolation: 分離性。直列可能性。同じデータを扱うトランザクションは順番に実行される。  
- Durability: トランザクションが保存した値は失われず、ログなどでリカバリ可能になっている。  

トランザクションは複数のオブジェクトに対する複数の操作をグループ化する。  

### 弱い分離レベル
#### read commited
多くのデータベースで採用されている実装。  
同じオブジェクト(行)に対する読み取り、書き込みはコミット後にでないと他の人からは読み取り、書き込みが出来ない。  
ダーティーリードを生じさせないために他のトランザクションがオブジェクトを更新している場合は読み取り側は古い値を読む。  
ダーティーライトを生じさせないために書き込み時にはオブジェクトに対して、書き込み前に行ロックを獲得する。  

#### スナップショット分離  
データベースがバックアップを行う場合や大規模データを分析する場合など大量のデータを読み取る際のためのトランザクション。  
大量のデータを読み取る際に裏側で更新が起こるとデータの不整合が起こる可能性がある。  
トランザクション開始時にコミット済みの状態のデータのスナップショットを作成する。  
MVCC(multi version concurrency controll)という名前が一般的。
